##  Redis的分片机制

Redis集群没有使用一致性Hash，而是引入了Hash槽的概念。

Redis Cluster采用虚拟哈希槽分区，所有的键根据哈希函数映射到0 ~ 16383整数槽内，每个key通过CRC16校验后对16384取模来决定放置在哪个槽（Slot），每一个节点负责维护一部分槽以及槽所映射的键值数据。

计算公式：slot = CRC16(key) & 16383

这种结构很容易添加或者删除节点，并且无论是添加删除或者修改某一个节点，都不会造成集群不可用的状态。使用哈希槽的好处就在于可以方便的添加或移除节点。

1、当需要增加节点时，只需要把其他节点的某些哈希槽挪到新节点就可以了。

2、当需要移除节点时，只需要把移除节点上的哈希槽挪到其他节点上就可以了。

![img](https://pic4.zhimg.com/80/v2-a372d2abb3f9fe189c5f0ddac17e3827_720w.jpg)

## 参考

https://zhuanlan.zhihu.com/p/99037321

