## IO多路复用

在进行IO时，我们不知道文件描述符对应的I/O设备是否时可读可写的，在外设的不可读或不可写状态下I/O只会导致进程阻塞或暂停运行。

所谓I/O多路复用指的是这样一个过程：

1、我们拿到了一堆文件描述符(不管是网络相关的、还是磁盘文件相关等等，任何文件描述符都可以)

2、通过调用某个函数告诉内核：“这个函数你先不要返回，你替我监视着这些描述符，当这堆文件描述符中有可以进行I/O读写操作的时候你再返回”

3、当调用的这个函数返回后我们就能知道哪些文件描述符可以进行I/O操作了。

#### 那么有哪些函数可以用来进行I/O多路复用呢？

在Linux世界中有这样三种机制可以用来进行I/O多路复用：

* select
* poll
* epoll

## select/poll/epoll之间的区别

|            | select              | poll             | epoll                                             |
| ---------- | ------------------- | ---------------- | ------------------------------------------------- |
| 数据结构   | bitmap              | 数组             | 红黑树                                            |
| 最大连接数 | 1024                | 无上限           | 无上限                                            |
| fd拷贝     | 每次调用select拷 贝 | 每次调用poll拷贝 | fd首次调用epoll_ctl拷贝，每次调用epoll_wait不拷贝 |
| 工作效率   | 轮询：O(n)          | 轮询：O(n)       | 回调：O(1)                                        |

## 参考

https://segmentfault.com/a/1190000038901651

