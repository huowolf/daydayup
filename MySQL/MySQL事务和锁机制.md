1、怎么理解InnoDB引擎中的事务？

事务可以使【**一组操作**】要么全部成功，要么全部失败。事务其目的是为了【**保证数据最终的一致性**】。

2、了解事务的几大特性吗？

ACID，分别是原子性（Atomicity）、一致性（Consistency）、隔离性（Isolation）、持久性（Durability）。

##### 原子性

​		原子性指的是：当前事务的操作要么同时成功，要么同时失败。原子性由undo log日志来保证，因为undo log记载着数据修改前的信息。

​		比如我们要insert一条数据，那undo log会记录一条对应的delete日志。我们要update一条记录时，那undo log会记录之前的旧值的update记录。

​		如果执行事务过程中出现异常的情况，那执行回滚。InnoDB引擎就是利用undo log记录下的数据，来将数据恢复到事务开始之前。

##### 隔离性

​		隔离性指的是：在事务并发执行时，他们内部的操作不能互相干扰。如果多个事务可以在同一个时刻操作同一份数据，那么就可能会产生脏读、重复读、幻读的问题。

​		于是事务之间需要存在一定的隔离。在InnoDB引擎中，定义了四种隔离级别供我们使用，分别是：read uncommit（读未提交）、read commit（读已提交）、repeatable read（可重复读）、serializable（串行化）。

​		不同的隔离级别对事务之间的隔离性是不一样的，级别越高事务隔离性越好，但性能就越低。隔离性是由MySQL的各种锁来实现的，只是它屏蔽了加锁的细节。

##### 持久性

​		持久性指的是：一旦提交了事务，它对数据库的修改就应该是永久性的。说白了就是，它会将数据持久化在磁盘上。

​		而持久性是由redo log日志来保证，当我们要修改数据时，MySQL是先把这条记录所在的**页**找到，然后把该页加载到内存中，将对应记录进行修改。

​		为了防止内存修改完了，MySQL就挂掉了（如果内存改完，直接挂掉，那这次的修改相当于丢失了），MySQL引入了redo log，内存写完了，然后会写一份redo log，这份redo log记载着这次在某个页上做了什么修改。即便MySQL在中途挂了，我们还可以根据redo log来对数据进行恢复。

​		redo log是顺序写的，写入速度很快。并且它记录的是物理修改，文件的体积很小，恢复速度也很快。

##### 一致性

​		一致性可以理解成我们使用事务的目的，而隔离性，原子性，持久性均是为了保证一致性的手段，保证一致性需要由应用程序代码来保证。

​		比如，如果事务在发生的过程中，出现了异常情况，此时你得回滚事务，而不是强行提交事务来导致数据不一致。

3、MySQL锁机制？

在InnoDB引擎下，按锁的粒度分类，可以简单分为行锁和表锁。

行锁实际上是作用在索引之上的。当我们的SQL命中了索引，那锁住的就是命中条件内的索引节点（这种就是行锁），如果没有命中索引，那我们锁住的就是整个索引数（表锁）。

简单来说就是：锁住的整棵树还是某几个节点，完全取决于SQL条件是否有命中到对应的索引节点。